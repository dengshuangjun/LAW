<!-- 主页大图 -->

<div id="update_fivPic" class="easyui-dialog" title="修改主页大图" data-options="iconCls:'icon-edit',resizable:true,modal:true,closed:true">
	<form class="fiv_main">
		<div style="height:50px; width:250px;margin:20px auto;">
			<span class="friInfo">友情提示:图片最佳像素为&nbsp;&nbsp;1200*300 </span>
			<br /><br />
			<label class="friConnlab">请选择您要替换成的图片:</label><input type="file" id="upFiv_pic" name="fivePic" onchange="previewMultipleImage2(this,'upFive_pic_show',450,170)"><br /><br />
		</div>
	</form>
	
	<div style="width:500px; height:200px; margin:0px auto;">
		<fieldset id="upFive_pic_show">
			<legend>图片预览</legend>
		</fieldset>
	</div>
	
	<a href="javascript:updateFivePic()" class="easyui-linkbutton" data-options="iconCls:'icon-edit'" style="display:block; margin:10px auto;width:60px;">修改</a>
</div>

<div class="lunboPic">
	<div class="mainLunboPic">
		<div class="lunboTop">
			<img height="90%" width="100%" src="front/images/lunbo1.jpg"/>
			<a href="javascript:void(0)" onclick="changePic(1)">点击修改此图片</a>
		</div>
		
		<div class="lunboTop">
			<img height="90%" width="100%" src="front/images/lunbo2.jpg"/>
			<a href="javascript:void(0)" onclick="changePic(2)">点击修改此图片</a>
		</div>
		
		<div class="lunboTop">
			<img height="90%" width="100%" src="front/images/lunbo3.jpg"/>
			<a href="javascript:void(0)" onclick="changePic(3)">点击修改此图片</a>
		</div>
		
	</div>
	<div class="mainLunboPic">
		<div class="lunboBottom1">
			<img height="90%" width="100%" src="front/images/lunbo4.jpg"/>
			<a href="javascript:void(0)" onclick="changePic(4)">点击修改此图片</a>
		</div>
		
		<div class="lunboBottom2">
			<img height="90%" width="100%" src="front/images/lunbo5.jpg"/>
			<a href="javascript:void(0)" onclick="changePic(5)">点击修改此图片</a>
		</div>
	</div>
</div>

<script>
	var count;//记录当前修改的是第几张图片
	//修改图片  1代表第一张 以此类推
	function changePic(num){
		count = num;
		$('#update_fivPic').dialog('open');
		picPath = 'front/images/lunbo'+num+'.jpg';
		$('#upFive_pic_show').html(showPrePic(picPath));
	}
	
	//重新加载五张大图
	function reloadFivePic(){
		var str='<div class="mainLunboPic">';
		for(var i=1;i<=3;i++){
			str+='<div class="lunboTop"><img height="90%" width="100%" src="front/images/lunbo'+i+'.jpg"/><a href="javascript:void(0)" onclick="changePic('+i+')">点击修改此图片</a></div>';
		}
		str+='</div>';
		str+='<div class="mainLunboPic"><div class="lunboBottom1"><img height="90%" width="100%" src="front/images/lunbo4.jpg"/><a href="javascript:void(0)" onclick="changePic(4)">点击修改此图片</a></div>';
		str+='<div class="lunboBottom2"><img height="90%" width="100%" src="front/images/lunbo5.jpg"/><a href="javascript:void(0)" onclick="changePic(5)">点击修改此图片</a></div></div>';
		$(".lunboPic").html(str);
	}
	
	//修改主页的五张大图
	function updateFivePic(){
		//1.可能为空值，即没有选择图片
		if($("#upFiv_pic").val() == ""){
			$.messager.alert('温馨提示','您未选择图片...','debug');
		}else{
			$.ajaxFileUpload({
				url:"fivePic/changePic",
				secureuri:false,
				fileElementId:"upFiv_pic",
				dataType:"json",
				data:{amount:count},
				success:function(data,status){
					if(data>0){
						$("#update_fivPic").dialog('close'); 
						$.messager.show({title:'成功提示',msg:'图片修改成功',timeout:2000,showType:'silde'});
						//修改之后怎么刷新整个页面
						reloadFivePic();
						/* friConnObj.datagrid("reload");*/
					}else{
						$.messager.alert("错误提示","图片修改失败\n","error");
					}  
				},
				error:function(data,status,e){
					$.messager.alert("错误提示","图片修改失败\n"+e,"error");
				}
			});
		}
	}

	//设置预览和修改时的图片显示
	function showPrePic(value){
		var str="";
		var pics=value.split(",");
		for(var i=0;i<pics.length;i++){
			str+="<img src='"+pics[i]+"' width='450px' height='170px'/>&nbsp;";
		}
		return str;
	}
</script>